module.exports=[96647,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(66338);let e=a=>{let b=a.replace(/^([A-Z])|[\s-_]+(\w)/g,(a,b,c)=>c?c.toUpperCase():b.toLowerCase());return b.charAt(0).toUpperCase()+b.slice(1)},f=(...a)=>a.filter((a,b,c)=>!!a&&""!==a.trim()&&c.indexOf(a)===b).join(" ").trim();var g={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let h=(0,c.forwardRef)(({color:a="currentColor",size:b=24,strokeWidth:d=2,absoluteStrokeWidth:e,className:h="",children:i,iconNode:j,...k},l)=>(0,c.createElement)("svg",{ref:l,...g,width:b,height:b,stroke:a,strokeWidth:e?24*Number(d)/Number(b):d,className:f("lucide",h),...!i&&!(a=>{for(let b in a)if(b.startsWith("aria-")||"role"===b||"title"===b)return!0})(k)&&{"aria-hidden":"true"},...k},[...j.map(([a,b])=>(0,c.createElement)(a,b)),...Array.isArray(i)?i:[i]])),i=(a,b)=>{let d=(0,c.forwardRef)(({className:d,...g},i)=>(0,c.createElement)(h,{ref:i,iconNode:b,className:f(`lucide-${e(a).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${a}`,d),...g}));return d.displayName=e(a),d},j=i("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),k=i("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),l=i("rocket",[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]]);function m({children:a}){return(0,b.jsx)("h3",{className:"border-b pb-2 text-sm font-semibold",style:{borderColor:"var(--bat-border)",color:"var(--bat-text)"},children:a})}function n({children:a,suggested:c=!1}){return(0,b.jsxs)("span",{className:"mb-1.5 block text-xs uppercase tracking-[0.1em]",style:{color:"var(--bat-text-muted)"},children:[a,c?(0,b.jsx)("span",{className:"ml-2 rounded-full px-2 py-0.5 text-[10px]",style:{color:"var(--bat-accent)",background:"var(--bat-accent-soft)"},children:"Suggested"}):null]})}function o(a){return(0,b.jsx)("input",{...a,className:`w-full rounded-xl border px-3 py-2 text-sm ${a.className||""}`,style:{borderColor:"var(--bat-border)",background:"var(--bat-surface)",color:"var(--bat-text)",...a.style||{}}})}function p(a){return(0,b.jsx)("textarea",{...a,className:`w-full rounded-xl border px-3 py-2 text-sm ${a.className||""}`,style:{borderColor:"var(--bat-border)",background:"var(--bat-surface)",color:"var(--bat-text)",...a.style||{}}})}function q({formData:a,updateField:c,suggestedFields:d}){let e=a=>d?.has(a);return(0,b.jsxs)("div",{className:"space-y-5",children:[(0,b.jsx)(m,{children:"Identity"}),(0,b.jsxs)("div",{className:"grid gap-3 md:grid-cols-2",children:[(0,b.jsxs)("label",{children:[(0,b.jsx)(n,{suggested:e("name"),children:"Brand name"}),(0,b.jsx)(o,{type:"text",value:a.name,onChange:a=>c("name",a.target.value),placeholder:"e.g. Bright Growth Studio",required:!0})]}),(0,b.jsxs)("label",{children:[(0,b.jsx)(n,{suggested:e("website"),children:"Website"}),(0,b.jsx)(o,{type:"text",value:a.website,onChange:a=>c("website",a.target.value),placeholder:"https://example.com"})]})]}),(0,b.jsxs)("label",{children:[(0,b.jsx)(n,{suggested:e("oneSentenceDescription"),children:"One-sentence business description"}),(0,b.jsx)(o,{type:"text",value:a.oneSentenceDescription,onChange:a=>c("oneSentenceDescription",a.target.value),placeholder:"What your brand does and for whom"})]}),(0,b.jsxs)("div",{className:"grid gap-3 md:grid-cols-2",children:[(0,b.jsxs)("label",{children:[(0,b.jsx)(n,{children:"Niche / industry"}),(0,b.jsx)(o,{type:"text",value:a.niche,onChange:a=>c("niche",a.target.value),placeholder:"e.g. Fitness coaching"})]}),(0,b.jsxs)("label",{children:[(0,b.jsx)(n,{children:"Business type"}),(0,b.jsx)(o,{type:"text",value:a.businessType,onChange:a=>c("businessType",a.target.value),placeholder:"Agency, SaaS, Creator, E-commerce..."})]})]}),(0,b.jsx)(m,{children:"Audience & Market"}),(0,b.jsxs)("div",{className:"grid gap-3 md:grid-cols-2",children:[(0,b.jsxs)("label",{children:[(0,b.jsx)(n,{children:"Where you operate"}),(0,b.jsx)(o,{type:"text",value:a.operateWhere,onChange:a=>c("operateWhere",a.target.value),placeholder:"Local, regional, global..."})]}),(0,b.jsxs)("label",{children:[(0,b.jsx)(n,{children:"Where you want more clients"}),(0,b.jsx)(o,{type:"text",value:a.wantClientsWhere,onChange:a=>c("wantClientsWhere",a.target.value),placeholder:"US, GCC, Europe..."})]})]}),(0,b.jsxs)("div",{className:"grid gap-3 md:grid-cols-2",children:[(0,b.jsxs)("label",{children:[(0,b.jsx)(n,{children:"Ideal audience (next 90 days)"}),(0,b.jsx)(o,{type:"text",value:a.idealAudience,onChange:a=>c("idealAudience",a.target.value),placeholder:"Who should BAT focus on first?"})]}),(0,b.jsxs)("label",{children:[(0,b.jsx)(n,{children:"Target audience"}),(0,b.jsx)(o,{type:"text",value:a.targetAudience,onChange:a=>c("targetAudience",a.target.value),placeholder:"Who are you trying to serve?"})]})]}),(0,b.jsxs)("label",{children:[(0,b.jsx)(n,{children:"Geo scope"}),(0,b.jsx)(o,{type:"text",value:a.geoScope,onChange:a=>c("geoScope",a.target.value),placeholder:"Global, MENA, US..."})]}),(0,b.jsx)(m,{children:"Offer & Goals"}),(0,b.jsxs)("label",{children:[(0,b.jsx)(n,{children:"Services list (comma or new line)"}),(0,b.jsx)(p,{rows:3,value:a.servicesList,onChange:a=>c("servicesList",a.target.value),placeholder:"Audit, Strategy, Content operations..."})]}),(0,b.jsxs)("label",{children:[(0,b.jsx)(n,{children:"Main offer"}),(0,b.jsx)(o,{type:"text",value:a.mainOffer,onChange:a=>c("mainOffer",a.target.value),placeholder:"Primary offer to push through content"})]}),(0,b.jsxs)("div",{className:"grid gap-3 md:grid-cols-2",children:[(0,b.jsxs)("label",{children:[(0,b.jsx)(n,{children:"Primary goal"}),(0,b.jsx)(o,{type:"text",value:a.primaryGoal,onChange:a=>c("primaryGoal",a.target.value),placeholder:"Leads, revenue, awareness..."})]}),(0,b.jsxs)("label",{children:[(0,b.jsx)(n,{children:"Secondary goals"}),(0,b.jsx)(o,{type:"text",value:a.secondaryGoals,onChange:a=>c("secondaryGoals",a.target.value),placeholder:"Retention, engagement..."})]})]}),(0,b.jsxs)("div",{className:"grid gap-3 md:grid-cols-2",children:[(0,b.jsxs)("label",{children:[(0,b.jsx)(n,{children:"Future business goal"}),(0,b.jsx)(o,{type:"text",value:a.futureGoal,onChange:a=>c("futureGoal",a.target.value),placeholder:"Expansion goal"})]}),(0,b.jsxs)("label",{children:[(0,b.jsx)(n,{children:"Engine goal"}),(0,b.jsx)(o,{type:"text",value:a.engineGoal,onChange:a=>c("engineGoal",a.target.value),placeholder:"What BAT should optimize for"})]})]}),(0,b.jsx)(m,{children:"Problems & Outcomes"}),(0,b.jsxs)("div",{className:"grid gap-3 md:grid-cols-2",children:[(0,b.jsxs)("label",{children:[(0,b.jsx)(n,{children:"Top problems solved"}),(0,b.jsx)(p,{rows:3,value:a.topProblems,onChange:a=>c("topProblems",a.target.value),placeholder:"3 main problems you solve"})]}),(0,b.jsxs)("label",{children:[(0,b.jsx)(n,{children:"Results expected in 90 days"}),(0,b.jsx)(p,{rows:3,value:a.resultsIn90Days,onChange:a=>c("resultsIn90Days",a.target.value),placeholder:"2 measurable outcomes"})]})]}),(0,b.jsxs)("label",{children:[(0,b.jsx)(n,{children:"Common pre-purchase questions"}),(0,b.jsx)(p,{rows:3,value:a.questionsBeforeBuying,onChange:a=>c("questionsBeforeBuying",a.target.value),placeholder:"What clients ask before buying"})]}),(0,b.jsx)(m,{children:"Voice & Constraints"}),(0,b.jsxs)("div",{className:"grid gap-3 md:grid-cols-2",children:[(0,b.jsxs)("label",{children:[(0,b.jsx)(n,{children:"Brand voice words"}),(0,b.jsx)(o,{type:"text",value:a.brandVoiceWords,onChange:a=>c("brandVoiceWords",a.target.value),placeholder:"Calm, precise, direct..."})]}),(0,b.jsxs)("label",{children:[(0,b.jsx)(n,{children:"Brand tone"}),(0,b.jsx)(o,{type:"text",value:a.brandTone,onChange:a=>c("brandTone",a.target.value),placeholder:"Premium, playful, formal..."})]})]}),(0,b.jsxs)("div",{className:"grid gap-3 md:grid-cols-2",children:[(0,b.jsxs)("label",{children:[(0,b.jsx)(n,{children:"Topics to avoid"}),(0,b.jsx)(o,{type:"text",value:a.topicsToAvoid,onChange:a=>c("topicsToAvoid",a.target.value),placeholder:"Unsafe promises, off-brand subjects..."})]}),(0,b.jsxs)("label",{children:[(0,b.jsx)(n,{children:"Business constraints"}),(0,b.jsx)(o,{type:"text",value:a.constraints,onChange:a=>c("constraints",a.target.value),placeholder:"Compliance, budget, team bandwidth..."})]})]}),(0,b.jsxs)("div",{className:"grid gap-3 md:grid-cols-2",children:[(0,b.jsxs)("label",{children:[(0,b.jsx)(n,{children:"Excluded categories"}),(0,b.jsx)(o,{type:"text",value:a.excludedCategories,onChange:a=>c("excludedCategories",a.target.value),placeholder:"Coupon sites, meme pages..."})]}),(0,b.jsxs)("label",{children:[(0,b.jsx)(n,{children:"Language"}),(0,b.jsx)(o,{type:"text",value:a.language,onChange:a=>c("language",a.target.value),placeholder:"English, Arabic..."})]})]}),(0,b.jsxs)("div",{className:"grid gap-3 md:grid-cols-3",children:[(0,b.jsxs)("label",{children:[(0,b.jsx)(n,{children:"Planning horizon"}),(0,b.jsx)(o,{type:"text",value:a.planningHorizon,onChange:a=>c("planningHorizon",a.target.value),placeholder:"90 days, 6 months..."})]}),(0,b.jsxs)("label",{children:[(0,b.jsx)(n,{children:"Autonomy level"}),(0,b.jsxs)("select",{value:a.autonomyLevel,onChange:a=>c("autonomyLevel",a.target.value||"assist"),className:"w-full rounded-xl border px-3 py-2 text-sm",style:{borderColor:"var(--bat-border)",background:"var(--bat-surface)",color:"var(--bat-text)"},children:[(0,b.jsx)("option",{value:"assist",children:"Assist (recommended)"}),(0,b.jsx)("option",{value:"auto",children:"Auto (non-destructive)"})]})]}),(0,b.jsxs)("label",{children:[(0,b.jsx)(n,{children:"Budget sensitivity"}),(0,b.jsx)(o,{type:"text",value:a.budgetSensitivity,onChange:a=>c("budgetSensitivity",a.target.value),placeholder:"Low, medium, high"})]})]}),(0,b.jsx)(m,{children:"Competitive Inspiration"}),(0,b.jsxs)("label",{children:[(0,b.jsx)(n,{children:"Competitor/inspiration links"}),(0,b.jsx)(p,{rows:3,value:a.competitorInspirationLinks,onChange:a=>c("competitorInspirationLinks",a.target.value),placeholder:"Up to 3 links, one per line"})]})]})}let r=i("instagram",[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]]),s=i("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]]),t=i("twitter",[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]]),u=[{id:"instagram",name:"Instagram",icon:r,placeholder:"username"},{id:"tiktok",name:"TikTok",icon:s,placeholder:"username"},{id:"youtube",name:"YouTube",icon:i("youtube",[["path",{d:"M2.5 17a24.12 24.12 0 0 1 0-10 2 2 0 0 1 1.4-1.4 49.56 49.56 0 0 1 16.2 0A2 2 0 0 1 21.5 7a24.12 24.12 0 0 1 0 10 2 2 0 0 1-1.4 1.4 49.55 49.55 0 0 1-16.2 0A2 2 0 0 1 2.5 17",key:"1q2vi4"}],["path",{d:"m10 15 5-3-5-3z",key:"1jp15x"}]]),placeholder:"channel"},{id:"twitter",name:"X/Twitter",icon:t,placeholder:"username"}];function v(a){return String(a||"").trim().replace(/^@+/,"").toLowerCase()}function w(a){return Object.values(a).filter(a=>v(a).length>0).length}function x({handles:a,onChange:c,suggestedPlatforms:d,suggestedHandleValidation:e}){let f=w(a);return(0,b.jsxs)("section",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[(0,b.jsx)("p",{className:"text-xs uppercase tracking-[0.12em]",style:{color:"var(--bat-text-muted)"},children:"Active Channels"}),(0,b.jsxs)("span",{className:"bat-chip",children:[f," selected"]})]}),(0,b.jsx)("div",{className:"grid gap-3",children:u.map(f=>{let g,h=f.icon,i=String(a[f.id]||""),j=v(i).length>0,k=d?.has(f.id),l="instagram"===f.id?e?.instagram:"tiktok"===f.id?e?.tiktok:void 0,m=l&&l.isLikelyClient&&l.confidence>=.75?"suggested":"warning";return(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"mb-1.5 flex items-center gap-2",children:[(0,b.jsx)("p",{className:"text-sm font-medium",children:f.name}),k?(0,b.jsx)("span",{className:"rounded-full px-2 py-0.5 text-[10px] uppercase tracking-[0.08em]",style:{background:"warning"===m?"color-mix(in srgb, var(--bat-warning) 18%, white)":"var(--bat-accent-soft)",color:"warning"===m?"var(--bat-warning)":"var(--bat-accent)"},children:"warning"===m?"Review":"Suggested"}):null]}),(0,b.jsxs)("label",{className:"relative block",children:[(0,b.jsx)("span",{className:"pointer-events-none absolute left-3 top-1/2 -translate-y-1/2",style:{color:j?"var(--bat-text)":"var(--bat-text-muted)"},children:(0,b.jsx)(h,{className:"h-4 w-4"})}),(0,b.jsx)("input",{type:"text",value:i,onChange:a=>c(f.id,a.target.value),className:"w-full rounded-xl border py-2.5 pl-10 pr-3 text-sm",style:{borderColor:"var(--bat-border)",background:"var(--bat-surface)",color:"var(--bat-text)"},placeholder:`@${f.placeholder}`})]}),l?.reason?(0,b.jsxs)("p",{className:"mt-1 text-xs",style:{color:"var(--bat-text-muted)"},children:[(g=Number(l.confidence||0))>=.75?"Likely your account":g>=.45?"Please confirm":"Needs review",": ",l.reason]}):null]},f.id)})}),(0,b.jsx)("p",{className:"text-xs",style:{color:"var(--bat-text-muted)"},children:"Add at least one handle to start discovery and evidence-based recommendations."})]})}let y={name:"",website:"",oneSentenceDescription:"",niche:"",businessType:"",operateWhere:"",wantClientsWhere:"",idealAudience:"",targetAudience:"",geoScope:"",servicesList:"",mainOffer:"",primaryGoal:"",secondaryGoals:"",futureGoal:"",engineGoal:"",topProblems:"",resultsIn90Days:"",questionsBeforeBuying:"",brandVoiceWords:"",brandTone:"",topicsToAvoid:"",constraints:"",excludedCategories:"",language:"",planningHorizon:"",autonomyLevel:"assist",budgetSensitivity:"",competitorInspirationLinks:"",handles:{instagram:"",tiktok:"",youtube:"",twitter:""}};function z(a){return String(a||"").split(",").map(a=>a.trim()).filter(Boolean)}function A(a,b=10){return String(a||"").split(/[\n,]+/).map(a=>a.trim()).filter(Boolean).slice(0,b)}function B(a){return a?{...y,...a,handles:{...y.handles,...a.handles||{}}}:{...y}}function C({workspaceId:a,initialPrefill:e,onCompleted:f}){let[g,h]=(0,c.useState)(1),[i,m]=(0,c.useState)(!1),[n,o]=(0,c.useState)(""),[p,r]=(0,c.useState)(B(e)),[s,t]=(0,c.useState)(new Set),[u,y]=(0,c.useState)(new Set),[C,D]=(0,c.useState)(),[E,F]=(0,c.useState)(!1),[G,H]=(0,c.useState)([]),[I,J]=(0,c.useState)(!1);(0,c.useEffect)(()=>{r(B(e))},[e]),(0,c.useEffect)(()=>{if(3!==g)return;let a=setTimeout(()=>{f().catch(a=>{o(String(a?.message||"Failed to open chat workspace")),h(2)})},1200);return()=>clearTimeout(a)},[f,g]);let K=(0,c.useMemo)(()=>w(p.handles),[p.handles]),L=(0,c.useMemo)(()=>Object.entries(p.handles).map(([a,b])=>({platform:a,handle:function(a,b){let c=String(b||"").trim();if(!c)return"";if("instagram"===a){let a=c.match(/instagram\.com\/([a-z0-9._]{2,30})/i);if(a)return v(a[1])}if("tiktok"===a){let a=c.match(/tiktok\.com\/@?([a-z0-9._]{2,30})/i);if(a)return v(a[1])}return v(c)}(a,b)})).filter(a=>a.handle.length>0),[p.handles]),M={MISSING_PRIMARY_CHANNEL:"No confirmed primary channel was detected yet (Instagram, TikTok, YouTube, or X/Twitter).",LOW_CONFIDENCE_SUGGESTION:"One or more suggested channels have low confidence and need your confirmation.",AI_NOT_CONFIGURED:"Suggestion service is currently unavailable. You can continue manually."},N=i||0===K,O=i||0===K||E&&!I;function P(a,b){r(c=>({...c,[a]:b}))}function Q(a,b){r(c=>({...c,handles:{...c.handles,[a]:b}})),E&&J(!1)}async function R(b){if(b.preventDefault(),m(!0),o(""),0===L.length){o("Add at least one social handle to continue."),m(!1);return}try{let b=await (0,d.suggestWorkspaceIntakeCompletion)(a,{...p,handles:p.handles});if(b?.success&&(b.suggested||b.suggestedHandles)){let{formData:a,suggestedKeys:c,suggestedHandlePlatforms:d}=function(a,b,c){let d=new Set,e=new Set,f={...a};for(let[a,c]of Object.entries(b||{}))a in f&&null!=c&&(Array.isArray(c)?f[a]=c.join("\n"):f[a]=String(c),d.add(a));if(c&&"object"==typeof c){let a={...f.handles};for(let[b,d]of Object.entries(c))d&&"string"==typeof d&&b in a&&(a[b]=d.trim(),e.add(b));f.handles=a}return{formData:f,suggestedKeys:d,suggestedHandlePlatforms:e}}(p,b.suggested||{},b.suggestedHandles);r(a),t(c),y(d),D(b.suggestedHandleValidation&&"object"==typeof b.suggestedHandleValidation?b.suggestedHandleValidation:void 0)}let c=b?.confirmationRequired===!0;F(c),H(Array.isArray(b?.confirmationReasons)?b.confirmationReasons:[]),J(!c),h(2)}catch(a){o(String(a?.message||"Suggestion failed")),F(!1),H([]),J(!0),h(2)}finally{m(!1)}}async function S(){if(m(!0),o(""),0===L.length){o("At least one social handle is required."),m(!1);return}if(E&&!I){o("Please confirm the suggested channels before starting."),m(!1);return}try{let b,c,e=(b=z(p.secondaryGoals),c=z(p.excludedCategories),{...p,servicesList:A(p.servicesList,20),topProblems:A(p.topProblems,3),resultsIn90Days:A(p.resultsIn90Days,2),questionsBeforeBuying:A(p.questionsBeforeBuying,3),competitorInspirationLinks:A(p.competitorInspirationLinks,3),secondaryGoals:b,excludedCategories:c,channels:L,handle:L[0]?.handle,platform:L[0]?.platform,surfaces:L.map(a=>a.platform),constraints:{operatorGoal:p.engineGoal,businessConstraints:p.constraints,excludedCategories:c,autonomyLevel:p.autonomyLevel,budgetSensitivity:p.budgetSensitivity,brandTone:p.brandTone,brandVoiceWords:p.brandVoiceWords,topicsToAvoid:A(p.topicsToAvoid,15),language:p.language,planningHorizon:p.planningHorizon}}),f=await (0,d.submitWorkspaceIntake)(a,e);if(!f?.success)throw Error("Failed to start smart workflow");h(3)}catch(a){o(String(a?.message||"Failed to submit intake"))}finally{m(!1)}}return(0,b.jsx)("section",{className:"space-y-4",children:(0,b.jsxs)("div",{className:"bat-surface p-6",children:[(0,b.jsxs)("div",{className:"mb-5 flex flex-wrap items-start justify-between gap-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs uppercase tracking-[0.12em]",style:{color:"var(--bat-text-muted)"},children:"Workspace Setup"}),(0,b.jsx)("h1",{className:"text-2xl font-semibold",children:"Initialize BAT Brain"}),(0,b.jsx)("p",{className:"mt-1 text-sm",style:{color:"var(--bat-text-muted)"},children:"Complete this intro once so BAT can run smart discovery and tailored planning."})]}),(0,b.jsxs)("span",{className:"bat-chip",children:["Step ",g," of 3"]})]}),1===g?(0,b.jsxs)("form",{className:"space-y-5",onSubmit:R,children:[(0,b.jsx)(q,{formData:p,updateField:P}),(0,b.jsx)(x,{handles:p.handles,onChange:Q}),n?(0,b.jsx)("div",{className:"rounded-xl border px-3 py-2 text-sm",style:{borderColor:"#f4b8b4",background:"#fff5f4",color:"#9f2317"},children:n}):null,(0,b.jsxs)("button",{type:"submit",disabled:N,className:"inline-flex items-center gap-2 rounded-full px-4 py-2 text-sm font-medium disabled:opacity-60",style:{background:"var(--bat-accent)",color:"white"},children:[(0,b.jsx)(l,{className:"h-4 w-4"}),i?"Checking suggestions...":`Continue (${K} channel${1===K?"":"s"})`]})]}):null,2===g?(0,b.jsxs)("div",{className:"space-y-5",children:[(0,b.jsx)("div",{className:"rounded-xl border px-4 py-3 text-sm",style:{borderColor:"var(--bat-border)",background:"var(--bat-surface-muted)",color:"var(--bat-text-muted)"},children:"Review and edit your setup, then start smart workflow."}),(0,b.jsx)(q,{formData:p,updateField:P,suggestedFields:s}),(0,b.jsx)(x,{handles:p.handles,onChange:Q,suggestedPlatforms:u,suggestedHandleValidation:C}),E?(0,b.jsxs)("div",{className:"rounded-xl border px-4 py-3",style:{borderColor:"color-mix(in srgb, var(--bat-warning) 45%, var(--bat-border))",background:"color-mix(in srgb, var(--bat-warning) 12%, white)"},children:[(0,b.jsxs)("p",{className:"mb-2 inline-flex items-center gap-2 text-sm font-semibold",style:{color:"var(--bat-warning)"},children:[(0,b.jsx)(j,{className:"h-4 w-4"}),"Confirmation required"]}),(0,b.jsx)("div",{className:"space-y-1 text-xs",style:{color:"var(--bat-text-muted)"},children:G.map(a=>(0,b.jsxs)("p",{children:["• ",M[a]||a]},a))}),(0,b.jsxs)("label",{className:"mt-3 inline-flex items-start gap-2 text-xs",style:{color:"var(--bat-text)"},children:[(0,b.jsx)("input",{type:"checkbox",checked:I,onChange:a=>J(a.target.checked),className:"mt-0.5"}),"I confirm these channels are correct and should be used to start BAT."]})]}):null,n?(0,b.jsx)("div",{className:"rounded-xl border px-3 py-2 text-sm",style:{borderColor:"#f4b8b4",background:"#fff5f4",color:"#9f2317"},children:n}):null,(0,b.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,b.jsx)("button",{type:"button",onClick:()=>h(1),className:"rounded-full border px-4 py-2 text-sm",style:{borderColor:"var(--bat-border)"},children:"Back"}),(0,b.jsxs)("button",{type:"button",onClick:S,disabled:O,className:"inline-flex items-center gap-2 rounded-full px-4 py-2 text-sm font-medium disabled:opacity-60",style:{background:"var(--bat-accent)",color:"white"},children:[(0,b.jsx)(l,{className:"h-4 w-4"}),i?"Starting...":"Confirm and start BAT"]})]})]}):null,3===g?(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)("div",{className:"inline-flex h-11 w-11 items-center justify-center rounded-2xl",style:{background:"var(--bat-accent-soft)",color:"var(--bat-accent)"},children:(0,b.jsx)(k,{className:"h-6 w-6"})}),(0,b.jsx)("h2",{className:"text-lg font-semibold",children:"Starting smart workflow"}),(0,b.jsxs)("p",{className:"text-sm",style:{color:"var(--bat-text-muted)"},children:["Discovery is running for ",Object.values(p.handles).map(a=>v(a)).filter(Boolean).map(a=>`@${a}`).join(", "),". Opening your chat workspace..."]})]}):null]})})}let D=i("layout-panel-left",[["rect",{width:"7",height:"18",x:"3",y:"3",rx:"1",key:"2obqm"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}]]),E=i("layout-panel-top",[["rect",{width:"18",height:"7",x:"3",y:"3",rx:"1",key:"f1a2em"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}]]),F=i("panel-left-open",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"m14 9 3 3-3 3",key:"8010ee"}]]);var G=a.i(50944);let H={tone:"balanced",sourceFocus:"mixed",transparency:!0,askQuestionsFirst:!1};function I(a){return"object"==typeof a&&null!==a&&!Array.isArray(a)}function J(a){return String(a||"").trim()||new Date().toISOString()}function K(a,b=12){return Array.isArray(a)?a.map(a=>String(a||"").trim()).filter(Boolean).slice(0,b):[]}function L(a){let b=new Date(a);return Number.isNaN(b.getTime())?"Now":b.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}let M=i("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]),N=i("square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]),O=i("arrow-up",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]),P=i("arrow-down",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]),Q=i("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),R=["Go deeper","Show sources","Make it a PDF","Focus on TikTok","Focus on Web evidence","Be concise","Ask me questions first"];function S({isStreaming:a,queuedMessages:d,onSend:e,onStop:f,onReorderQueue:g,onDeleteQueued:h,onSteer:i}){let[j,k]=(0,c.useState)("");return(0,b.jsxs)("section",{className:"bat-surface p-4",children:[(0,b.jsxs)("div",{className:"mb-3 flex flex-wrap items-center justify-between gap-2",children:[(0,b.jsx)("p",{className:"text-sm font-medium",children:"Steer BAT"}),(0,b.jsxs)("span",{className:"bat-chip",children:["Queued: ",d.length]})]}),(0,b.jsx)("div",{className:"mb-3 flex flex-wrap gap-2",children:R.map(a=>(0,b.jsx)("button",{type:"button",onClick:()=>i(a),className:"rounded-full border px-3 py-1.5 text-xs",style:{borderColor:"var(--bat-border)",background:"var(--bat-surface-muted)"},children:a},a))}),d.length>0?(0,b.jsxs)("div",{className:"mb-3 rounded-xl border p-3",style:{borderColor:"var(--bat-border)",background:"var(--bat-surface-muted)"},children:[(0,b.jsx)("p",{className:"text-xs uppercase tracking-[0.08em]",style:{color:"var(--bat-text-muted)"},children:"Message Queue"}),(0,b.jsx)("div",{className:"mt-2 space-y-2",children:d.map((a,c)=>(0,b.jsxs)("div",{className:"flex items-center gap-2 rounded-xl border p-2",style:{borderColor:"var(--bat-border)"},children:[(0,b.jsx)("p",{className:"flex-1 text-sm",children:a.content}),(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)("button",{type:"button","aria-label":"Move up",onClick:()=>g(c,c-1),className:"rounded-full border p-1",style:{borderColor:"var(--bat-border)"},children:(0,b.jsx)(O,{className:"h-3 w-3"})}),(0,b.jsx)("button",{type:"button","aria-label":"Move down",onClick:()=>g(c,c+1),className:"rounded-full border p-1",style:{borderColor:"var(--bat-border)"},children:(0,b.jsx)(P,{className:"h-3 w-3"})}),(0,b.jsx)("button",{type:"button","aria-label":"Remove",onClick:()=>h(a.id),className:"rounded-full border p-1",style:{borderColor:"var(--bat-border)"},children:(0,b.jsx)(Q,{className:"h-3 w-3"})})]})]},a.id))})]}):null,(0,b.jsxs)("form",{onSubmit:b=>{b.preventDefault();let c=j.trim();if(c){if(a){e(c,window.confirm("BAT is currently running. Press OK to interrupt and send now, or Cancel to queue this message.")?"send":"queue"),k("");return}e(c,"send"),k("")}},className:"flex gap-2",children:[(0,b.jsx)("textarea",{value:j,onChange:a=>k(a.target.value),placeholder:"Ask BAT to run analysis, generate a brief, or adjust strategy...",className:"min-h-[84px] flex-1 rounded-2xl border px-3 py-2 text-sm outline-none",style:{borderColor:"var(--bat-border)",background:"var(--bat-surface)"}}),(0,b.jsxs)("div",{className:"flex w-28 flex-col gap-2",children:[(0,b.jsxs)("button",{type:"submit",className:"inline-flex items-center justify-center gap-1 rounded-full px-3 py-2 text-sm font-semibold",style:{background:"var(--bat-accent)",color:"white"},children:[a?(0,b.jsx)(s,{className:"h-4 w-4"}):(0,b.jsx)(M,{className:"h-4 w-4"}),a?"Send":"Run"]}),a?(0,b.jsxs)("button",{type:"button",onClick:f,className:"inline-flex items-center justify-center gap-1 rounded-full border px-3 py-2 text-sm",style:{borderColor:"var(--bat-border)"},children:[(0,b.jsx)(N,{className:"h-4 w-4"})," Stop"]}):null]})]})]})}let T=i("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),U=i("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);function V({message:a}){let[d,e]=(0,c.useState)(!1);return a.reasoning?(0,b.jsxs)("div",{className:"mt-3 rounded-xl border p-3",style:{borderColor:"var(--bat-border)",background:"var(--bat-surface-muted)"},children:[(0,b.jsxs)("button",{type:"button",className:"flex w-full items-center justify-between text-sm font-semibold",onClick:()=>e(a=>!a),children:["How BAT got here",d?(0,b.jsx)(U,{className:"h-4 w-4"}):(0,b.jsx)(T,{className:"h-4 w-4"})]}),d?(0,b.jsxs)("div",{className:"mt-3 space-y-3 text-sm",style:{color:"var(--bat-text-muted)"},children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-semibold",style:{color:"var(--bat-text)"},children:"Plan"}),(0,b.jsx)("ul",{className:"mt-1 list-disc pl-5",children:a.reasoning.plan.map(a=>(0,b.jsx)("li",{children:a},a))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-semibold",style:{color:"var(--bat-text)"},children:"Tools used"}),(0,b.jsx)("div",{className:"mt-1 flex flex-wrap gap-2",children:a.reasoning.tools.map(a=>(0,b.jsx)("span",{className:"bat-chip",children:a},a))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-semibold",style:{color:"var(--bat-text)"},children:"Assumptions"}),(0,b.jsx)("ul",{className:"mt-1 list-disc pl-5",children:a.reasoning.assumptions.map(a=>(0,b.jsx)("li",{children:a},a))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-semibold",style:{color:"var(--bat-text)"},children:"Next steps"}),(0,b.jsx)("ul",{className:"mt-1 list-disc pl-5",children:a.reasoning.nextSteps.map(a=>(0,b.jsx)("li",{children:a},a))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-semibold",style:{color:"var(--bat-text)"},children:"Evidence"}),(0,b.jsx)("div",{className:"mt-1 flex flex-wrap gap-2",children:a.reasoning.evidence.map(a=>a.href?(0,b.jsx)("a",{href:a.href,target:"_blank",rel:"noreferrer",className:"bat-chip hover:opacity-80",children:a.label},a.id):(0,b.jsx)("span",{className:"bat-chip",children:a.label},a.id))})]})]}):null]}):null}function W({messages:a,onForkFromMessage:c}){return a.length?(0,b.jsx)("section",{className:"bat-surface flex min-h-[55vh] flex-col gap-4 p-4 md:p-5",children:a.map(a=>(0,b.jsxs)("article",{className:"max-w-[92%] rounded-2xl border px-4 py-3",style:{borderColor:"user"===a.role?"transparent":"var(--bat-border)",marginLeft:"user"===a.role?"auto":0,background:"user"===a.role?"var(--bat-accent-soft)":"var(--bat-surface)"},children:[(0,b.jsxs)("div",{className:"mb-2 flex items-center justify-between gap-2",children:[(0,b.jsx)("p",{className:"text-xs uppercase tracking-[0.12em]",style:{color:"var(--bat-text-muted)"},children:a.role}),c?(0,b.jsx)("button",{type:"button",onClick:()=>c(a.id),className:"rounded-full border px-2 py-1 text-[11px]",style:{borderColor:"var(--bat-border)"},children:"Fork from here"}):null]}),(0,b.jsx)("p",{className:"whitespace-pre-wrap text-sm md:text-[15px]",children:a.content}),"assistant"===a.role?(0,b.jsx)(V,{message:a}):null]},a.id))}):(0,b.jsx)("section",{className:"bat-surface flex min-h-[55vh] items-center justify-center p-6 text-center",children:(0,b.jsx)("p",{className:"max-w-md text-sm",style:{color:"var(--bat-text-muted)"},children:"Start by asking BAT for an analysis, a 30-day plan, or a competitor audit. Results and approvals will appear here in one thread."})})}let X=i("command",[["path",{d:"M15 6v12a3 3 0 1 0 3-3H6a3 3 0 1 0 3 3V6a3 3 0 1 0-3 3h12a3 3 0 1 0-3-3",key:"11bfej"}]]),Y=i("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]),Z=["Run competitor discovery","Generate PDF deliverable","Open library: Web","Open library: Competitors","Add constraint","Switch workspace"];function $({onSelect:a}){let[d,e]=(0,c.useState)(!1),[f,g]=(0,c.useState)("");(0,c.useEffect)(()=>{let a=a=>{(a.metaKey||a.ctrlKey)&&"k"===a.key.toLowerCase()&&(a.preventDefault(),e(a=>!a)),"Escape"===a.key&&e(!1)};return window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)},[]);let h=(0,c.useMemo)(()=>{let a=f.trim().toLowerCase();return Z.filter(b=>!a||b.toLowerCase().includes(a))},[f]);return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("button",{type:"button",onClick:()=>e(!0),className:"rounded-full border px-3 py-1.5 text-sm",style:{borderColor:"var(--bat-border)",background:"var(--bat-surface)"},children:(0,b.jsxs)("span",{className:"inline-flex items-center gap-2",children:[(0,b.jsx)(X,{className:"h-4 w-4"})," Command"]})}),d?(0,b.jsx)("div",{className:"fixed inset-0 z-50 grid place-items-start bg-black/30 pt-[15vh]",children:(0,b.jsxs)("div",{className:"w-full max-w-xl rounded-2xl border p-3",style:{background:"var(--bat-surface)",borderColor:"var(--bat-border)"},children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 rounded-xl border px-3 py-2",style:{borderColor:"var(--bat-border)"},children:[(0,b.jsx)(Y,{className:"h-4 w-4"}),(0,b.jsx)("input",{value:f,onChange:a=>g(a.target.value),placeholder:"Search commands",className:"w-full bg-transparent outline-none"}),(0,b.jsx)("button",{type:"button",onClick:()=>e(!1),children:(0,b.jsx)(Q,{className:"h-4 w-4"})})]}),(0,b.jsx)("div",{className:"mt-2 space-y-1",children:h.map(c=>(0,b.jsx)("button",{type:"button",onClick:()=>{a(c),e(!1)},className:"block w-full rounded-xl px-3 py-2 text-left text-sm hover:bg-black/5",children:c},c))})]})}):null]})}let _=i("clock-3",[["path",{d:"M12 6v6h4",key:"135r8i"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),aa=i("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),ab=i("circle-pause",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"10",x2:"10",y1:"15",y2:"9",key:"c1nkhi"}],["line",{x1:"14",x2:"14",y1:"15",y2:"9",key:"h65svq"}]]),ac=i("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);function ad({status:a}){return"running"===a?(0,b.jsx)(aa,{className:"h-4 w-4 animate-spin",style:{color:"var(--bat-accent)"}}):"waiting_input"===a?(0,b.jsx)(ab,{className:"h-4 w-4",style:{color:"var(--bat-warning)"}}):"done"===a?(0,b.jsx)(k,{className:"h-4 w-4",style:{color:"var(--bat-success)"}}):"failed"===a?(0,b.jsx)(ac,{className:"h-4 w-4",style:{color:"#b3261e"}}):(0,b.jsx)(_,{className:"h-4 w-4",style:{color:"var(--bat-text-muted)"}})}function ae({runs:a}){return(0,b.jsx)("div",{className:"space-y-3",children:a.map(a=>(0,b.jsxs)("article",{className:"rounded-xl border p-3",style:{borderColor:"var(--bat-border)"},children:[(0,b.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,b.jsx)("p",{className:"text-sm font-semibold",children:a.label}),(0,b.jsx)(ad,{status:a.status})]}),(0,b.jsx)("p",{className:"mt-1 text-xs",style:{color:"var(--bat-text-muted)"},children:a.stage}),(0,b.jsx)("div",{className:"mt-2 h-2 rounded-full",style:{background:"var(--bat-surface-muted)"},children:(0,b.jsx)("div",{className:"h-2 rounded-full transition-all",style:{width:`${Math.max(0,Math.min(100,a.progress))}%`,background:"var(--bat-accent)"}})}),(0,b.jsxs)("p",{className:"mt-1 text-xs",style:{color:"var(--bat-text-muted)"},children:[a.progress,"%"]})]},a.id))})}function af({feedItems:a}){return(0,b.jsx)("div",{className:"space-y-2",children:a.map(a=>(0,b.jsxs)("article",{className:"rounded-xl border p-3",style:{borderColor:"var(--bat-border)"},children:[(0,b.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,b.jsx)("p",{className:"text-xs uppercase tracking-[0.08em]",style:{color:"var(--bat-text-muted)"},children:a.timestamp}),a.actionLabel?(0,b.jsx)("button",{type:"button",className:"rounded-full border px-2 py-1 text-xs",style:{borderColor:"var(--bat-border)"},children:a.actionLabel}):null]}),(0,b.jsx)("p",{className:"mt-1 text-sm",children:a.message})]},a.id))})}function ag({decisions:a,onResolve:c}){return a.length?(0,b.jsx)("div",{className:"space-y-3",children:a.map(a=>(0,b.jsxs)("article",{className:"rounded-xl border p-3",style:{borderColor:"var(--bat-border)"},children:[(0,b.jsx)("p",{className:"text-sm font-semibold",children:a.prompt}),(0,b.jsx)("div",{className:"mt-3 flex flex-wrap gap-2",children:a.options.map(d=>(0,b.jsx)("button",{type:"button",onClick:()=>c(a.id,d),className:"rounded-full border px-3 py-1.5 text-xs",style:{borderColor:"var(--bat-border)",background:"var(--bat-surface-muted)"},children:d},d))})]},a.id))}):(0,b.jsx)("div",{className:"rounded-xl border p-3 text-sm",style:{borderColor:"var(--bat-border)",color:"var(--bat-text-muted)"},children:"No pending approvals right now."})}function ah({runs:a,feedItems:d,decisions:e,onResolve:f}){let[g,h]=(0,c.useState)("running"),i=(0,c.useMemo)(()=>[{id:"running",label:"Now Running"},{id:"feed",label:"Activity Feed"},{id:"decisions",label:"Approvals"}],[]);return(0,b.jsxs)("aside",{className:"bat-surface h-full p-4",children:[(0,b.jsxs)("div",{className:"mb-3 flex items-center justify-between",children:[(0,b.jsx)("h2",{className:"text-base font-semibold",children:"Live Activity"}),(0,b.jsx)("span",{className:"bat-chip",children:"Client Friendly View"})]}),(0,b.jsx)("div",{className:"mb-4 grid grid-cols-3 gap-1 rounded-full p-1",style:{background:"var(--bat-surface-muted)"},children:i.map(a=>(0,b.jsx)("button",{type:"button",onClick:()=>h(a.id),className:"rounded-full px-2 py-1 text-xs",style:{background:g===a.id?"var(--bat-surface)":"transparent",border:g===a.id?"1px solid var(--bat-border)":"1px solid transparent"},children:a.label},a.id))}),(0,b.jsxs)("div",{className:"max-h-[62vh] overflow-y-auto pr-1",children:["running"===g?(0,b.jsx)(ae,{runs:a}):null,"feed"===g?(0,b.jsx)(af,{feedItems:d}):null,"decisions"===g?(0,b.jsx)(ag,{decisions:e,onResolve:f}):null]})]})}let ai=[{id:"all",label:"All"},{id:"web",label:"Web"},{id:"competitors",label:"Competitors"},{id:"social",label:"Social"},{id:"community",label:"Community"},{id:"news",label:"News"},{id:"deliverables",label:"Deliverables"}];function aj({open:a,onClose:d,items:e,activeCollection:f,onCollectionChange:g,onUseInChat:h}){let[i,j]=(0,c.useState)(""),k=(0,c.useMemo)(()=>e.filter(a=>{let b="all"===f||a.collection===f,c=i.trim().toLowerCase(),d=!c||a.title.toLowerCase().includes(c)||a.summary.toLowerCase().includes(c)||a.tags.join(" ").toLowerCase().includes(c);return b&&d}),[f,e,i]);return a?(0,b.jsxs)("div",{className:"fixed inset-0 z-40 flex",children:[(0,b.jsx)("button",{type:"button","aria-label":"close drawer",className:"h-full flex-1 bg-black/25",onClick:d}),(0,b.jsxs)("aside",{className:"h-full w-full max-w-md border-l p-4",style:{background:"var(--bat-surface)",borderColor:"var(--bat-border)"},children:[(0,b.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold",children:"Library"}),(0,b.jsx)("button",{type:"button",onClick:d,className:"rounded-full border p-2",style:{borderColor:"var(--bat-border)"},children:(0,b.jsx)(Q,{className:"h-4 w-4"})})]}),(0,b.jsx)("div",{className:"rounded-xl border px-3 py-2",style:{borderColor:"var(--bat-border)"},children:(0,b.jsxs)("label",{className:"flex items-center gap-2 text-sm",style:{color:"var(--bat-text-muted)"},children:[(0,b.jsx)(Y,{className:"h-4 w-4"}),(0,b.jsx)("input",{value:i,onChange:a=>j(a.target.value),placeholder:"Search evidence",className:"w-full border-none bg-transparent outline-none"})]})}),(0,b.jsx)("div",{className:"my-3 flex flex-wrap gap-2",children:ai.map(a=>(0,b.jsx)("button",{type:"button",onClick:()=>g(a.id),className:"rounded-full border px-3 py-1.5 text-xs",style:{borderColor:"var(--bat-border)",background:f===a.id?"var(--bat-accent-soft)":"var(--bat-surface-muted)"},children:a.label},a.id))}),(0,b.jsx)("div",{className:"space-y-2 overflow-y-auto pb-4",style:{maxHeight:"calc(100vh - 220px)"},children:k.map(a=>(0,b.jsxs)("article",{className:"rounded-xl border p-3",style:{borderColor:"var(--bat-border)"},children:[(0,b.jsx)("p",{className:"text-sm font-semibold",children:a.title}),(0,b.jsx)("p",{className:"mt-1 text-xs",style:{color:"var(--bat-text-muted)"},children:a.summary}),(0,b.jsx)("div",{className:"mt-2 flex flex-wrap gap-1",children:a.tags.map(a=>(0,b.jsx)("span",{className:"bat-chip",children:a},a))}),(0,b.jsxs)("p",{className:"mt-2 text-xs",style:{color:"var(--bat-text-muted)"},children:[a.freshness," • ",a.evidenceLabel]}),(0,b.jsx)("button",{type:"button",onClick:()=>h(a),className:"mt-2 rounded-full border px-3 py-1 text-xs",style:{borderColor:"var(--bat-border)"},children:"Use in answer"})]},a.id))})]})]}):null}let ak={"Go deeper":{pref:["tone","balanced"],prompt:"Go deeper with the current strategy and include lane-by-lane recommendations."},"Show sources":{pref:["transparency",!0],prompt:"Show every claim with source evidence and confidence level."},"Make it a PDF":{prompt:"Generate a client-ready PDF deliverable from this branch."},"Focus on TikTok":{pref:["sourceFocus","social"],prompt:"Prioritize TikTok and social evidence in the next response."},"Focus on Web evidence":{pref:["sourceFocus","web"],prompt:"Prioritize web evidence and cite pages directly."},"Be concise":{pref:["tone","concise"]},"Ask me questions first":{pref:["askQuestionsFirst",!0]}};function al({workspaceId:a}){let[e,f]=(0,c.useState)(!1),[g,h]=(0,c.useState)(!1),[i,j]=(0,c.useState)("all"),[k,l]=(0,c.useState)(null),m=(0,G.useRouter)(),{loading:n,syncing:o,error:p,threads:q,activeThreadId:r,activeBranchId:s,branches:t,messages:u,processRuns:v,feedItems:w,decisions:x,queuedMessages:y,isStreaming:z,libraryItems:A,preferences:B,setActiveThreadId:C,createThread:M,createBranch:N,pinBranch:O,sendMessage:P,interruptRun:Q,reorderQueue:R,removeQueued:T,resolveDecision:U,setPreference:V,refreshNow:X}=function(a){let[b,e]=(0,c.useState)(!0),[f,g]=(0,c.useState)(!1),[h,i]=(0,c.useState)(null),[j,k]=(0,c.useState)([]),[l,m]=(0,c.useState)(null),[n,o]=(0,c.useState)(null),[p,q]=(0,c.useState)([]),[r,s]=(0,c.useState)([]),[t,u]=(0,c.useState)([]),[v,w]=(0,c.useState)([]),[x,y]=(0,c.useState)([]),[z,A]=(0,c.useState)(H),B=(0,c.useRef)(null),C=(0,c.useMemo)(()=>j.find(a=>a.id===l)||null,[l,j]),D=(0,c.useMemo)(()=>C?.branches||[],[C]),E=(0,c.useCallback)(a=>{m(a);let b=j.find(b=>b.id===a);b&&o(b.pinnedBranchId||b.branches?.[0]?.id||null)},[j]),F=(0,c.useCallback)(a=>{o(a)},[]),G=(0,c.useCallback)(async b=>{g(!0);try{let[c,e,f,g,h]=await Promise.all([(0,d.listRuntimeThreads)(a),(0,d.listRuntimeMessages)(a,b),(0,d.listRuntimeEvents)(a,b),(0,d.listRuntimeQueue)(a,b),(0,d.fetchRuntimeBranchState)(a,b)]);k(c),m(a=>{if(a&&c.some(b=>b.id===a))return a;let d=c.find(a=>a.branches?.some(a=>a.id===b))||c[0]||null;return d?.id||null});let j=e.messages.filter(a=>"TOOL"!==String(a.role||"").toUpperCase()).map(a=>{let b,c=I(a.reasoningJson)?a.reasoningJson:null,d=(c&&Array.isArray(c.evidence)?c.evidence:[]).map(a=>{if(!I(a))return null;let b=String(a.id||"").trim(),c=String(a.label||"").trim();return b&&c?{id:b,label:c,..."string"==typeof a.url?{href:a.url}:{}}:null}).filter(a=>!!a);return{id:String(a.id||""),role:(b=String(a.role||"SYSTEM").trim().toUpperCase(),"USER"===b?"user":"ASSISTANT"===b?"assistant":"system"),content:String(a.content||""),createdAt:J(a.createdAt),...c?{reasoning:{plan:K(c.plan),tools:K(c.tools),assumptions:K(c.assumptions),nextSteps:K(c.nextSteps),evidence:d}}:{}}}),l=f.events,n=h.activeRuns||[];q(j),u([...l].slice(-60).reverse().map(a=>{let b=String(a.type||"").toUpperCase(),c="PROCESS_RESULT"===b?"Open result":"DECISION_REQUIRED"===b?"Review options":void 0;return{id:String(a.id||`${a.createdAt||Math.random()}`),timestamp:L(J(a.createdAt)),message:String(a.message||""),...c?{actionLabel:c}:{}}})),w(function(a,b){let c=[],d=new Set(b.filter(a=>"WAITING_USER"===String(a.status||"").toUpperCase()).map(a=>String(a.id||"").trim()).filter(Boolean));if(0===d.size)return[];for(let b of[...a].slice(-160)){let a=String(b.agentRunId||"").trim();if(!a||!d.has(a))continue;let e=I(b.payloadJson)?b.payloadJson:null;if(e&&Array.isArray(e.decisions))for(let a of e.decisions){if(!I(a))continue;let b=String(a.id||"").trim(),d=String(a.title||"").trim();if(!b||!d)continue;let e=Array.isArray(a.options)?a.options.map(a=>"string"==typeof a?a.trim():I(a)?String(a.label||a.value||"").trim():"").filter(Boolean):[];e.length&&(c.some(a=>a.id===b)||c.push({id:b,prompt:d,options:e}))}}return c}(l,n)),s(n.map(a=>{let b=String(a.status||"RUNNING").toUpperCase(),c=Array.isArray(a.toolRuns)?a.toolRuns:[],d=c.length||1,e=c.filter(a=>I(a)&&"DONE"===String(a.status||"").toUpperCase()).length,f="DONE"===b?100:Math.min(95,Math.round(e/d*100)),g="WAITING_USER"===b?"Waiting for approval":"WAITING_TOOLS"===b?`Running ${c.length||1} task(s)`:"QUEUED"===b?"Queued":"FAILED"===b?"Failed":"CANCELLED"===b?"Cancelled":"DONE"===b?"Completed":"Running";return{id:String(a.id||""),label:`Run ${String(a.triggerType||"workflow").toLowerCase().replace(/_/g," ")}`,stage:g,progress:f,status:"WAITING_USER"===b?"waiting_input":"DONE"===b?"done":"FAILED"===b?"failed":"CANCELLED"===b?"cancelled":"running"}})),y((g.queue||[]).map(a=>({id:String(a.id),content:String(a.content),createdAt:J(a.createdAt)}))),i(null)}catch(a){i(String(a?.message||"Failed to sync runtime data"))}finally{g(!1)}},[a]),M=(0,c.useCallback)(async()=>{let b=await (0,d.listRuntimeThreads)(a);if(!b.length){let c=await (0,d.createRuntimeThread)(a,{title:"Main workspace thread",createdBy:"portal-user"});b=[{...c.thread,branches:c.thread.branches||[c.mainBranch]}]}k(b);let c=b[0],e=c?.id||null,f=c?.pinnedBranchId||c?.branches?.[0]?.id||null;m(e),o(f)},[a]),N=(0,c.useCallback)(async()=>{n&&await G(n)},[n,G]),O=(0,c.useCallback)(async(b,c)=>{if(!n)return;let e=b.trim();if(!e)return;let f="queue"===c?"queue":r.some(a=>"running"===a.status)?"interrupt":"send";await (0,d.sendRuntimeMessage)(a,n,{content:e,userId:"portal-user",mode:f,policy:{autoContinue:!z.askQuestionsFirst,maxAutoContinuations:+("concise"!==z.tone),maxToolRuns:"concise"===z.tone?2:4,toolConcurrency:"mixed"===z.sourceFocus?3:2,allowMutationTools:!1,maxToolMs:3e4,sourceFocus:z.sourceFocus,transparency:z.transparency}}),await G(n)},[n,z,r,G,a]),P=(0,c.useCallback)(async()=>{n&&(await (0,d.interruptRuntimeBranch)(a,n,"Interrupted by user"),await G(n))},[n,G,a]),Q=(0,c.useCallback)(async(b,c)=>{if(!n||b<0||c<0||b>=x.length||c>=x.length)return;let e=[...x],[f]=e.splice(b,1);e.splice(c,0,f),await (0,d.reorderRuntimeQueue)(a,n,e.map(a=>a.id)),await G(n)},[n,x,G,a]),R=(0,c.useCallback)(async b=>{n&&(await (0,d.cancelRuntimeQueueItem)(a,n,b),await G(n))},[n,G,a]),S=(0,c.useCallback)(async(a,b)=>{await O(`Decision ${a}: ${b}`,"send")},[O]),T=(0,c.useCallback)(async b=>{let c=await (0,d.createRuntimeThread)(a,{title:b.trim()||"New thread",createdBy:"portal-user"});m(c.thread.id),o(c.mainBranch.id),await G(c.mainBranch.id)},[G,a]),U=(0,c.useCallback)(async(b,c)=>{if(!l||!n)return;let e={name:b.trim()||`Branch ${new Date().toLocaleTimeString()}`,createdBy:"portal-user",forkedFromBranchId:n,...c?{forkedFromMessageId:c}:{}},f=await (0,d.createRuntimeBranch)(a,l,e);await (0,d.pinRuntimeBranch)(a,l,f.branch.id),o(f.branch.id),await G(f.branch.id)},[n,l,G,a]),V=(0,c.useCallback)(async b=>{let c=l||j.find(a=>a.branches?.some(a=>a.id===b))?.id||null;c&&(await (0,d.pinRuntimeBranch)(a,c,b),m(c),o(b),await G(b))},[l,G,j,a]),W=(0,c.useCallback)((a,b)=>{A(c=>({...c,[a]:b}))},[]);return(0,c.useEffect)(()=>{let a=!0;return e(!0),i(null),M().catch(b=>{a&&i(String(b?.message||"Failed to initialize runtime workspace"))}).finally(()=>{a&&e(!1)}),()=>{a=!1}},[M,a]),(0,c.useEffect)(()=>{if(n)return G(n),B.current&&(clearInterval(B.current),B.current=null),B.current=setInterval(()=>{G(n)},2200),()=>{B.current&&(clearInterval(B.current),B.current=null)}},[n,G]),(0,c.useEffect)(()=>{if(!l)return;let a=j.find(a=>a.id===l);!a||a.branches?.some(a=>a.id===n)||o(a.pinnedBranchId||a.branches?.[0]?.id||null)},[n,l,j]),{loading:b,syncing:f,error:h,threads:j,activeThreadId:l,activeBranchId:n,branches:D,messages:p,processRuns:r,feedItems:t,decisions:v,queuedMessages:x,isStreaming:r.some(a=>"running"===a.status||"waiting_input"===a.status),libraryItems:function(a){let b=[];for(let c of a)if(c.reasoning?.evidence?.length)for(let a of c.reasoning.evidence)b.push({id:`${c.id}-${a.id}`,collection:"web",title:a.label,summary:`Referenced in assistant message ${c.id.slice(0,8)}`,freshness:L(c.createdAt),tags:["evidence","chat"],evidenceLabel:a.label,...a.href?{evidenceHref:a.href}:{}});return b.slice(0,60)}(p),preferences:z,setActiveThreadId:E,setActiveBranchId:F,createThread:T,createBranch:U,pinBranch:V,sendMessage:O,interruptRun:P,reorderQueue:Q,removeQueued:R,resolveDecision:S,setPreference:W,refreshNow:N}}(a),Y=(0,c.useMemo)(()=>w.slice(0,8),[w]),Z=v.some(a=>"waiting_input"===a.status),_=a=>{l(null),a.catch(a=>{l(String(a?.message||"Action failed"))})},aa=a=>{let b=window.prompt("Branch name",`What-if ${new Date().toLocaleTimeString()}`);b&&_(N(b,a))};return n?(0,b.jsx)("section",{className:"bat-surface p-6",children:(0,b.jsx)("p",{className:"text-sm",style:{color:"var(--bat-text-muted)"},children:"Initializing workspace runtime..."})}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"mb-3 space-y-3",children:[(0,b.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs uppercase tracking-[0.13em]",style:{color:"var(--bat-text-muted)"},children:"Workspace"}),(0,b.jsx)("h1",{className:"text-xl font-semibold",children:a})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("button",{type:"button",className:"rounded-full border px-3 py-1.5 text-sm",style:{borderColor:"var(--bat-border)"},onClick:()=>h(a=>!a),children:(0,b.jsxs)("span",{className:"inline-flex items-center gap-2",children:[(0,b.jsx)(F,{className:"h-4 w-4"})," Library"]})}),(0,b.jsx)("button",{type:"button",className:"rounded-full border px-3 py-1.5 text-sm",style:{borderColor:"var(--bat-border)"},onClick:()=>f(a=>!a),children:(0,b.jsxs)("span",{className:"inline-flex items-center gap-2",children:[e?(0,b.jsx)(D,{className:"h-4 w-4"}):(0,b.jsx)(E,{className:"h-4 w-4"}),e?"Split Mode":"Focus Mode"]})}),(0,b.jsx)($,{onSelect:a=>{if("Open library: Web"===a){h(!0),j("web");return}if("Open library: Competitors"===a){h(!0),j("competitors");return}"Switch workspace"===a?m.push("/app"):_(P(a,z?"queue":"send"))}})]})]}),(0,b.jsxs)("div",{className:"bat-surface flex flex-wrap items-end gap-3 p-3",children:[(0,b.jsxs)("label",{className:"text-xs uppercase tracking-[0.08em]",style:{color:"var(--bat-text-muted)"},children:["Thread",(0,b.jsx)("select",{value:r||"",onChange:a=>C(a.target.value),className:"mt-1 block min-w-[220px] rounded-xl border px-3 py-2 text-sm",style:{borderColor:"var(--bat-border)",background:"var(--bat-surface)"},children:q.map(a=>(0,b.jsx)("option",{value:a.id,children:a.title},a.id))})]}),(0,b.jsxs)("label",{className:"text-xs uppercase tracking-[0.08em]",style:{color:"var(--bat-text-muted)"},children:["Branch",(0,b.jsx)("select",{value:s||"",onChange:a=>_(O(a.target.value)),className:"mt-1 block min-w-[220px] rounded-xl border px-3 py-2 text-sm",style:{borderColor:"var(--bat-border)",background:"var(--bat-surface)"},children:t.map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id))})]}),(0,b.jsx)("button",{type:"button",className:"rounded-full border px-3 py-2 text-sm",style:{borderColor:"var(--bat-border)"},onClick:()=>{let a=window.prompt("Thread name","Main workspace thread");a&&_(M(a))},children:"New Thread"}),(0,b.jsx)("button",{type:"button",className:"rounded-full border px-3 py-2 text-sm",style:{borderColor:"var(--bat-border)"},onClick:()=>aa(),children:"Fork Branch"}),(0,b.jsx)("button",{type:"button",className:"rounded-full border px-3 py-2 text-sm",style:{borderColor:"var(--bat-border)"},onClick:()=>_(X()),children:"Refresh"}),(0,b.jsx)("span",{className:"bat-chip",children:o?"Syncing...":z?"Running":"Idle"}),(0,b.jsxs)("span",{className:"bat-chip",children:["Queued: ",y.length]}),Z?(0,b.jsx)("span",{className:"bat-chip",children:"Needs decision"}):null,B.askQuestionsFirst?(0,b.jsx)("span",{className:"bat-chip",children:"Question-first mode"}):null]}),p||k?(0,b.jsx)("div",{className:"rounded-2xl border p-3 text-sm",style:{borderColor:"#f4b8b4",background:"#fff5f4",color:"#9f2317"},children:(0,b.jsx)("p",{children:p||k})}):null]}),(0,b.jsxs)("div",{className:`grid gap-4 ${e?"grid-cols-1":"grid-cols-1 xl:grid-cols-[1fr,360px]"}`,children:[(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)(W,{messages:u,onForkFromMessage:aa}),(0,b.jsx)(S,{isStreaming:z,queuedMessages:y,onSend:(a,b)=>{_(P(a,b))},onStop:()=>_(Q()),onReorderQueue:(a,b)=>_(R(a,b)),onDeleteQueued:a=>_(T(a)),onSteer:a=>{let b=ak[a];if(b){if(b.pref){let[a,c]=b.pref;"tone"===a&&("balanced"===c||"concise"===c)&&V("tone",c),"sourceFocus"===a&&("mixed"===c||"web"===c||"social"===c)&&V("sourceFocus",c),"transparency"===a&&"boolean"==typeof c&&V("transparency",c),"askQuestionsFirst"===a&&"boolean"==typeof c&&V("askQuestionsFirst",c)}b.prompt&&_(P(b.prompt,z?"queue":"send"))}}}),e?(0,b.jsxs)("section",{className:"bat-surface flex items-center justify-between gap-2 p-3 text-sm",children:[(0,b.jsxs)("p",{children:["Live activity in compact mode. ",(0,b.jsx)("strong",{children:v.filter(a=>"running"===a.status).length})," ","active process(es)."]}),(0,b.jsx)("span",{className:"bat-chip",children:o?"syncing":"ready"})]}):null]}),e?null:(0,b.jsx)(ah,{runs:v,feedItems:Y,decisions:x,onResolve:(a,b)=>_(U(a,b))})]}),(0,b.jsx)(aj,{open:g,onClose:()=>h(!1),items:A,activeCollection:i,onCollectionChange:j,onUseInChat:a=>{var b;return b=a.title,void(_(P(`Use evidence from: ${b}`,z?"queue":"send")),h(!1))}})]})}function am({workspaceId:a}){let[e,f]=(0,c.useState)(!0),[g,h]=(0,c.useState)(null),[i,j]=(0,c.useState)(null),k=(0,c.useCallback)(async()=>{f(!0);try{let b=await (0,d.fetchWorkspaceIntakeStatus)(a);h(b),j(null)}catch(a){j(String(a?.message||"Failed to load workspace setup status"))}finally{f(!1)}},[a]);return((0,c.useEffect)(()=>{k()},[k]),e)?(0,b.jsx)("section",{className:"bat-surface p-6",children:(0,b.jsx)("p",{className:"text-sm",style:{color:"var(--bat-text-muted)"},children:"Checking workspace setup..."})}):i?(0,b.jsxs)("section",{className:"bat-surface space-y-3 p-6",children:[(0,b.jsx)("p",{className:"text-sm",style:{color:"#9f2317"},children:i}),(0,b.jsx)("button",{type:"button",onClick:()=>{k()},className:"rounded-full border px-4 py-2 text-sm",style:{borderColor:"var(--bat-border)"},children:"Retry"})]}):g?.completed?(0,b.jsx)(al,{workspaceId:a}):(0,b.jsx)(C,{workspaceId:a,initialPrefill:g?.prefill,onCompleted:k})}a.s(["ChatOsLayout",()=>am],96647)}];

//# sourceMappingURL=apps_client-portal_src_components_chat_chat-os-layout_tsx_4599b5ff._.js.map