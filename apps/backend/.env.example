# OpenAI API
OPENAI_API_KEY=OPENAI_API_KEY_FROM_SECRET_MANAGER

# AI mode
AI_FALLBACK_MODE=off               # Use "mock" only in non-production local testing
MAX_TOKENS_PER_CALL=4000            # Maximum tokens per API call
MONTHLY_AI_BUDGET=200.00            # Monthly budget in USD ($200 = ~100 businesses)
COST_ALERT_THRESHOLD=150.00         # Alert when costs exceed this ($150 = 75% of budget)

# Node Environment
NODE_ENV=development
# PORT is used in production (e.g., Railway). BACKEND_PORT remains supported for local/dev.
# PORT=3001
BACKEND_PORT=3001

# Database
DATABASE_URL=postgresql://user:password@localhost:5433/dbname

# Apify (Instagram scraping + media URL resolving)
APIFY_API_TOKEN=APIFY_API_TOKEN_FROM_SECRET_MANAGER
APIFY_ACTOR_ID=apify~instagram-api-scraper
APIFY_MEDIA_DOWNLOADER_TOKEN=APIFY_MEDIA_DOWNLOADER_TOKEN_FROM_SECRET_MANAGER
APIFY_MEDIA_DOWNLOADER_ACTOR_ID=igview-owner~instagram-video-downloader

# Orchestration (continuous orchestrator runs every N minutes)
# ORCHESTRATION_INTERVAL_MINUTES=15
# Minimum hours between orchestrator-triggered client scrapes (Apify/Instagram, TikTok) per job. Reduces cost from repeated gap-triggered runs.
ORCHESTRATOR_CLIENT_SCRAPE_THROTTLE_HOURS=6

# Continuity loop (auto-continue scraping)
RESEARCH_CONTINUITY_POLL_MS=60000

# Research event persistence + retention
RESEARCH_EVENTS_RETENTION_DAYS=30
RESEARCH_EVENTS_MAX_PER_JOB=5000
RESEARCH_EVENTS_PRUNE_INTERVAL_MS=21600000

# Social scraping limits (Instagram defaults to 50; TikTok uses SOCIAL_SCRAPE_POST_LIMIT)
INSTAGRAM_POST_LIMIT=50
# SOCIAL_SCRAPE_POST_LIMIT=4
# Social media download controls (keeps continue cycles responsive)
SOCIAL_MEDIA_DOWNLOAD_POST_LIMIT=8
SOCIAL_MEDIA_MAX_FAILURES=3
SOCIAL_MEDIA_FAILURE_COOLDOWN_MS=43200000
# Set true to download TikTok video/photo page URLs via Camoufox (tiktok.com/.../video/... or .../photo/...)
ENABLE_TIKTOK_PAGE_DOWNLOAD=false

# Downloader + scraper proxy/IP rotation (comma-separated URLs)
# SCRAPER_PROXY_URLS=http://user:pass@proxy1:8080,http://user:pass@proxy2:8080
# INSTAGRAM_SCRAPER_PROXY_URLS=http://user:pass@ig-proxy1:8080,http://user:pass@ig-proxy2:8080
# TIKTOK_SCRAPER_PROXY_URLS=http://user:pass@tt-proxy1:8080,http://user:pass@tt-proxy2:8080
# TIKTOK_DOWNLOADER_PROXY_URLS=http://user:pass@tt-dl-proxy1:8080,http://user:pass@tt-dl-proxy2:8080
# YOUTUBE_SCRAPER_PROXY_URLS=http://user:pass@yt-proxy1:8080,http://user:pass@yt-proxy2:8080
# INSTAGRAM_MEDIA_RESOLVER_PROXY_URLS=http://user:pass@ig-media-proxy1:8080,http://user:pass@ig-media-proxy2:8080
# MEDIA_DOWNLOADER_PROXY_URLS=http://user:pass@dl-proxy1:8080,http://user:pass@dl-proxy2:8080
# MEDIA_PROXY_ALLOW_DIRECT=true
# SCRAPER_PROXY_ALLOW_DIRECT=true
# MEDIA_PROXY_MAX_FAILURES=2
# MEDIA_PROXY_COOLDOWN_MS=120000
# SCRAPER_PROXY_MAX_FAILURES=2
# SCRAPER_PROXY_COOLDOWN_MS=120000
# MEDIA_DOWNLOAD_MAX_ATTEMPTS=3
# MEDIA_DOWNLOAD_TIMEOUT_MS=60000
# SCRAPER_COMMAND_MAX_ATTEMPTS=3
# INSTAGRAM_MEDIA_RESOLVE_ATTEMPTS=2
# INSTAGRAM_CAMOUFOX_SCRAPE_ATTEMPTS=2
# INSTAGRAM_PYTHON_SCRAPE_ATTEMPTS=2
# TIKTOK_CAMOUFOX_SCRAPE_ATTEMPTS=2
# TIKTOK_YTDLP_SCRAPE_ATTEMPTS=3
# TIKTOK_CAMOUFOX_DOWNLOAD_ATTEMPTS=2
# TIKTOK_PUPPETEER_DOWNLOAD_ATTEMPTS=2
# YOUTUBE_INFO_ATTEMPTS=2
# YOUTUBE_DOWNLOAD_ATTEMPTS=3

# Expected Costs Per Business:
# - 12 AI Questions: ~$1.12 (one-time per research job)
# - Document Generation: ~$0.48 (per strategy document)
# - Total: ~$1.60 per complete brand strategy
# 
# Budget of $200/month supports approximately:
# - 100 businesses with 25% safety margin
# - Or 125 businesses at full capacity
